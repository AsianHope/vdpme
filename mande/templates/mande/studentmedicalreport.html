{% extends "base.html" %}
{% load mandefilters %}
{% block title %}
{% if not visits %}
Student Medical and Dental Report
{% elif visits %}
Student Medical and Dental Report <small>{{startDate}} to {{endDate}}</small>
{% endif %}
{% endblock %}

{% block content %}
{% if visits %}
<div class="col-md-9">
      <table class="table table-bordered table-striped table-hover" id="medicalReportTable">
        <thead><tr>
          <th>Site</th>
          <th>Student</th>
          <th>Check-Ups</th>
          <th>Dental Visits</th>

        </tr></thead>
        <tbody>
            {% for student, key in visits.items %}
              <tr>
                  <td>{{ student.site }}</td>
                  <td><a href="{% url 'student_detail' student.student_id %}">{{ student }}</a></td>
                  <td>{{key.checkup}}</td>
                  <td>{{key.dental}}</td>
                  </tr>
          {% endfor %}
        </tbody>

      </table>
    </div>

{% endif %}

    <div class="col-md-3">
        <form method="post" action="{% url 'student_medical_report' %}">
          {% csrf_token %}
          <div class="col-md-12">
            <div class="form-group">
              From:<br>
              <input type="date" name="startDate" class="form-control" id="datePicker1">
            </div>
            <div class="form-group">
              To:<br>
              <input type="date" name="endDate" class="form-control" id="datePicker2">
            </div>
            <div class="form-group">
              <input type="button" value="Search" class="btn btn-primary form-control" id="submit">
            </div>
          </div>
        </form>
    </div>

{% endblock %}

{% block script %}
 <!-- DataTables JavaScript -->
<script type="text/javascript">
$('#datePicker1').val('{{startDate}}');
$('#datePicker2').val('{{endDate}}');
$(function() {
  $('#submit').click(function() {
      url = '{% url 'student_medical_report'%}' + $('#datePicker1').val() +"\\"+ $('#datePicker2').val()
        window.location.href = url
      });
    });
$(document).ready(function(){
  $('#medicalReportTable').DataTable({
      responsive: true,
      pageLength: 25,
      order: [[0,'asc']],
      dom: 'frtipB',
      buttons: [
        {
                 extend: 'csvHtml5',
                 text: 'TSV export <i class="fa fa-download"></i>',
                 className: 'btn btn-sm btn-success',
                 fieldSeparator: '\t',
                 extension: '.tsv',
                 title: 'StudentMedical'
             },

    ]
  });
});
</script>
<link type="text/css" href="/media/jquery/css/smoothness/jquery-ui-1.8.18.custom.css" rel="Stylesheet" />
<script type="text/javascript" src="/media/jquery/js/jquery-1.7.1.min.js"></script>
<script type="text/javascript" src="/media/jquery/js/jquery-ui-1.8.18.custom.min.js"></script>
{% endblock %}
