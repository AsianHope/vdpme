{% load mathfilters %}
<head>
  <link href="//netdna.bootstrapcdn.com/bootstrap/3.0.2/css/bootstrap.min.css"
        rel="stylesheet">
  <script type="text/javascript">
  window.onload = function () {
    var genderchartpkpn = new CanvasJS.Chart("genderReportPKPN",
	{
		title:{
			text: "PKPN"
		},
                animationEnabled: true,
		data: [
		{
			type: "doughnut",
			startAngle: 60,
			toolTipContent: "{legendText}: {y} ",
			showInLegend: false,
			dataPoints: [
      {% with boys=surveys|length %}
      {% with girls=females|length %}
      {  y: {{boys|sub:girls}} , indexlabel: "Male",legendText:"M"},
      {% endwith %}
      {% endwith %}
				{y: {{females|length}}, indexLabel: "Female", legendText: "F" },
			]
		}
		]
	});

  var genderchartppt = new CanvasJS.Chart("genderReportPPT",
{
  title:{
    text: "PPT"
  },
              animationEnabled: true,
  data: [
  {
    type: "doughnut",
    startAngle: 60,
    toolTipContent: "{legendText}: {y} ",
    showInLegend: false,
    dataPoints: [
    {% with boys=surveys|length %}
    {% with girls=females|length %}
    {  y: {{boys|sub:girls}} , indexlabel: "Male",legendText:"M"},
    {% endwith %}
    {% endwith %}
      {y: {{females|length}}, indexLabel: "Female", legendText: "F" },
    ]
  }
  ]
});

var gendercharttk = new CanvasJS.Chart("genderReportTK",
{
title:{
  text: "TK"
},
            animationEnabled: true,
data: [
{
  type: "doughnut",
  startAngle: 60,
  toolTipContent: "{legendText}: {y} ",
  showInLegend: false,
  dataPoints: [
  {% with boys=surveys|length %}
  {% with girls=females|length %}
  {  y: {{boys|sub:girls}} , indexlabel: "Male",legendText:"M"},
  {% endwith %}
  {% endwith %}
    {y: {{females|length}}, indexLabel: "Female", legendText: "F" },
  ]
}
]
});
var achievementpkpn = new CanvasJS.Chart("achievmentpkpn",
{  theme: "theme2",
  title:{
    text: "Students at grade level"
  },
              animationEnabled: true,
  data: [
  {
    type: "doughnut",
    startAngle: 180,
    toolTipContent: "{legendText}: {y} ",
    showInLegend: false,
    dataPoints: [
     {y: 225 , indexlabel: "At Grade Level",legendText:"At Grade Level"},
      {y: {{females|length}}, indexLabel: "Not At Grade Level", legendText: "Not At Grade Level" },
    ]
  }
  ]
});
    var agechart = new CanvasJS.Chart("ageReport",
    {
      title:{
      text: "Age Breakdown"
      },
      axisY:{
        title:"Number of Students"
      },
      animationEnabled: true,
      data: [
      {
        type: "stackedColumn",
        toolTipContent: "{label}<br/><span style='\"'color: {color};'\"'><strong>{name}</strong></span>: {y}",
        name: "Grade 1",
        showInLegend: "true",
        dataPoints: [
        {% with boys=surveys|length %}
        {% with girls=females|length %}
        {  y: {{boys|sub:girls}} , label: "PKPN"},
        {% endwith %}
        {% endwith %}
        {  y: 100 , label: "PPT"},
        {  y: 75 , label: "TK"},
        {  y: 200 , label: "Total"},


        ]
      },  {
        type: "stackedColumn",
        toolTipContent: "{label}<br/><span style='\"'color: {color};'\"'><strong>{name}</strong></span>: {y}",
        name: "Grade 2",
        showInLegend: "true",
        dataPoints: [
        {  y: {{females|length}} , label: "PKPN"},
        {  y: 100 , label: "PPT"},
        {  y: 85 , label: "TK"},
        {  y: 300 , label: "Total"},


        ]
      },  {
        type: "stackedColumn",
        toolTipContent: "{label}<br/><span style='\"'color: {color};'\"'><strong>{name}</strong></span>: {y}",
        name: "Grade 3",
        showInLegend: "true",
        dataPoints: [
        {  y: {{females|length}} , label: "PKPN"},
        {  y: 100 , label: "PPT"},
        {  y: 85 , label: "TK"},
        {  y: 300 , label: "Total"},


        ]
      },  {
        type: "stackedColumn",
        toolTipContent: "{label}<br/><span style='\"'color: {color};'\"'><strong>{name}</strong></span>: {y}",
        name: "Grade 4",
        showInLegend: "true",
        dataPoints: [
        {  y: {{females|length}} , label: "PKPN"},
        {  y: 100 , label: "PPT"},
        {  y: 85 , label: "TK"},
        {  y: 300 , label: "Total"},


        ]
      },  {
        type: "stackedColumn",
        toolTipContent: "{label}<br/><span style='\"'color: {color};'\"'><strong>{name}</strong></span>: {y}",
        name: "Grade 5",
        showInLegend: "true",
        dataPoints: [
        {  y: {{females|length}} , label: "PKPN"},
        {  y: 100 , label: "PPT"},
        {  y: 85 , label: "TK"},
        {  y: 300 , label: "Total"},


        ]
      },  {
        type: "stackedColumn",
        toolTipContent: "{label}<br/><span style='\"'color: {color};'\"'><strong>{name}</strong></span>: {y}",
        name: "Grade 6",
        showInLegend: "true",
        dataPoints: [
        {  y: {{females|length}} , label: "PKPN"},
        {  y: 100 , label: "PPT"},
        {  y: 85 , label: "TK"},
        {  y: 300 , label: "Total"},


        ]
      }
      ]
      ,
      legend:{
        cursor:"pointer",
        itemclick: function(e) {
          if (typeof (e.dataSeries.visible) ===  "undefined" || e.dataSeries.visible) {
            e.dataSeries.visible = false;
          }
          else
          {
            e.dataSeries.visible = true;
          }
          agechart.render();
        }
      }
    });
    genderchartpkpn.render();
    genderchartppt.render();
    gendercharttk.render();

    achievementpkpn.render();
    agechart.render();
  }
  </script>
 <script type="text/javascript" src="https://services.asianhope.org/cdn/canvasjs.min.js"></script></head>

<div class="container">
<h1>at a glance</h1>

<div class="row col-md-12" style="border: 1px solid gray;">
  <h2>Catch up schools</h2>
  <div class = "row">
    <div class="col-md-3">
      <table class="table table-striped table-bordered table-hover">
        <tr><td colspan=3>Total students: <strong>{{surveys|length}}</strong></td></tr>
        <tr><td>PKPN: <strong>234</strong></td><td>TK: <strong>75</strong></td><td>PPT: <strong>230</strong></td></tr>
        <tr><td>F: <strong>245</strong></td><td>M: <strong>123</strong></td></tr>
      </table>
      <table class="table table-striped table-bordered table-hover">
        <tr><td colspan=6>By Grade:</td></tr>
        <tr><td>1: <strong>245</strong></td>
             <td>2: <strong>123</strong></td>
             <td>3: <strong>123</strong></td>
             <td>4: <strong>123</strong></td>
             <td>5: <strong>123</strong></td>
             <td>6: <strong>123</strong></td>
        </tr>
      </table>

      <table class="table table-striped table-bordered table-hover">
        <tr><td colspan=3>Skill Training:</td></tr>
        <tr><td>English: <strong>245</strong></td>
             <td>Vietnamese: <strong>123</strong></td>
             <td>Computer: <strong>123</strong></td>
        </tr>
      </table>
    </div>
    <div class="col-md-12">
      <div id="genderReportPKPN" class="col-md-3" style="height: 300px;"></div>
      <div id="genderReportPPT" class="col-md-3" style="height: 300px;"></div>
      <div id="genderReportTK" class="col-md-3" style="height: 300px;"></div>
    </div>
  </div>
  <div class="row">
    <div class = "col-md-12">
      <div id="achievmentpkpn" class="col-md-6" style="height: 300px; width: 50%;"></div>
      <div id="ageReport" class="col-md-6" style="height: 300px; width: 50%;"></div>
    </div>
  </div>
</div>





<h1>Intake Surveys</h1>
<table class="table table-striped">
    {% for survey in surveys %}

    <tr>
      <td><a href ="{% url 'student_detail' survey.student_id %}">{{ survey.student_id }}</a></td>
      <td>{{survey.name}}</td>
      <td>{{survey.gender}}</td>
      <td>{{survey.dob}}</td>
      <td>{{survey.student_id}}</td>

    {% endfor %}
</ul>
</div>
